
from telegram import Update
from telegram.ext import ApplicationBuilder, CommandHandler, ContextTypes
from apscheduler.schedulers.background import BackgroundScheduler
from datetime import datetime
import logging

logging.basicConfig(level=logging.INFO)

users = {}  # user_id: start_time

morning_messages = [
    "بیدار شو تنبلا! محمد عاشقت منتظره... ☀️",
    "صبح بخیر خانومی که حتی توی خوابم دلم براش تنگ می‌شه 😘",
    "چشاتو وا کن ببین که محمد هنوزم مثل دیروز عاشق‌تره 💕",
    "یه صبح دیگه، یه روز دیگه برای دوست داشتنت، سحرِ من! ☀️",
    "پاشو که دلم واسه صدات قنج می‌ره 😍",
    "سحر، امروز قراره دوباره با فکر تو شروع شه... مثل همیشه ❤️",
    "صبح بخیر خانوم دلم، خواب‌هات شیرین بود؟ دیشب مهمونت بودم 😉",
    "صبح که تو بخندی، کل جهان خوبه 😄",
    "بهترین قسمت صبحم، فکر کردن به توئه، بانو ✨",
    "خورشید هنوز کامل درنیومده، ولی تو که بخندی، روزم روشن می‌شه ☀️",
    "دلم برات تنگ شده بود از دیشب تا الان! صبح بخیر عشقم 💌",
    "صبح بخیر سحر جون! ببین محمد هنوز عاشقته 😍",
    "بیدار شو که روز بدون خنده‌ات بی‌معنیه 😁",
    "صبح بخیر به بانوی قلبم، خوشگل‌ترین سحر دنیا 🌸",
    "سحر یعنی تو، یعنی شیرین‌ترین شروع روز من ☀️",
    "از خواب بیدار شو که دلتنگتم 😘",
    "یه سلام پر از عشق از محمد، برای سحر زیبای من 💋",
    "صبح بخیر فرشته‌ی نازنینم 💖",
    "دلم می‌خواد امروزتو با لبخند من شروع کنی 😄",
    "صبح بخیر خاص‌ترین دختر دنیا 😍",
    "تو بخندی، صبحم قشنگ‌تر می‌شه 🌤️",
    "بیداری؟ دلم یه دنیا حرف داره برات امروز... ☀️",
    "صبح یعنی صدای تو، لبخند تو، عشق تو 💘",
    "هر روز صبح دلیل بیداریم فقط تویی 😴💞",
    "پاشو پاشو... محمد منتظره با عشق خاصش 😏",
    "یه روز دیگه، یه عاشقی دیگه با تو سحر جونم 🌸",
    "صبحا فقط وقتی قشنگن که تو توشون باشی 😇",
    "صبح بخیر به دختری که با فکرش شبمو خوابیدم 💤",
    "بیدار شو ببین محمد چقدر دوستت داره 🌅",
    "صبح‌هات شیرین‌تر از خواب‌هات باشه عزیز دلم 💕",
]

night_messages = [
    "شب بخیر قشنگم، بخواب که دلم آروم شه ❤️",
    "می‌دونستی شب‌هام فقط وقتی قشنگه که بدونم تو آرومی؟ 😴",
    "یه بوس کوچولو برای شب بخیر از راه دور 😘",
    "تو بخوابی یا نه، محمد تا صبح با فکر تو بیداره 💭",
    "پتو رو بکش رو دلت، ولی بدون دل من هنوز زیر پتوی عشقت گرمه 😌",
    "سحر، بخواب که خواب‌هات پر از شیطنت‌های عاشقونه‌مون باشه 😉",
    "یه شب دیگه گذشت و من هنوزم عاشق‌ترم... شب بخیر عشقم ❤️",
    "از من بپرس؟ بهترین دعای شب: خوابای خوش برای تو 🌙",
    "شبت خوش بانو، دنیا بدون تو اصلاً قشنگ نمی‌خوابه 😴",
    "چشماتو ببند، من اینجام... تو فکر تو، تا طلوع ☀️",
    "بخواب عزیزم... محمد الانم داره بهت فکر می‌کنه 💖",
    "سحر عزیزم، شب بخیر... امشبم خواب منی 😍",
    "شبت قشنگ‌تر از خیال من باشه، خانومی 😘",
    "دل محمد با صدای خروپف تو هم عاشق‌تر می‌شه 😜",
    "فردا هم عاشق‌تر از امروز منتظرتم... شب بخیر 💌",
    "شب یعنی سکوت، سکوت یعنی تو، تو یعنی عشق 😴",
    "خواب ببینی محمد بغلت کرده... بخواب عشقم 🥰",
    "پاشو نری بخوابی بدون شب‌بخیر من 😅",
    "شب بخیر به ماه‌منیر قلبم 🌙✨",
    "با فکر تو می‌خوابم امشبم مثل هر شب 💭💋",
    "یه روز دیگه گذشت و من باز بیشتر عاشقتم 💖",
    "دعا می‌کنم امشب خواب‌هات پر از خنده‌هامون باشه 😄",
    "آروم بخواب که آروم‌ترین صدای دلمه 💘",
    "بخواب نازنینم، فردا هم یه روز عاشقانه دیگه با تو 🌅",
    "تو بخوابی، دنیا قشنگ‌تر می‌شه 😇",
    "سحر جونم، شب بخیر... تا فردا که با صدات بیدار شم ❤️",
    "امشبم دلمو گذاشتم زیر بالش سرت، مراقبش باش 😍",
    "دل‌تنگتم حتی وقتی می‌خوام بخوابم 💤",
    "شب بخیر ملکه‌ی قلبم، توی خواب می‌بینمت 👑",
    "محمد دوستت داره، حتی توی خواب‌هات... 😘",
]

scheduler = BackgroundScheduler()
scheduler.start()

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_chat.id
    users[user_id] = datetime.now()
    await context.bot.send_message(chat_id=user_id, text="سلام سحر جون! 🤗\nاز همین لحظه محمد هر روز ساعت ۶ صبح و ۱۰ شب برات پیام عاشقونه می‌فرسته.\nفقط منتظر باش... 💌")

def send_message(bot, user_id, message_list):
    if user_id not in users:
        return
    day = (datetime.now() - users[user_id]).days
    if day < len(message_list):
        message = message_list[day]
        bot.send_message(chat_id=user_id, text=message)
    else:
        bot.send_message(chat_id=user_id, text="۳۰ روز گذشت ولی هنوز دلم با توئه... 🥹")

def schedule_messages(application):
    def send_all_morning():
        for user_id in users:
            send_message(application.bot, user_id, morning_messages)

    def send_all_night():
        for user_id in users:
            send_message(application.bot, user_id, night_messages)

    scheduler.add_job(send_all_morning, 'cron', hour=6, minute=0)
    scheduler.add_job(send_all_night, 'cron', hour=22, minute=0)

app = ApplicationBuilder().token("7611934506:AAFrAwq8FEmNFPCkhLyTCv_HwOW9X-FOwgw").build()
app.add_handler(CommandHandler("start", start))
schedule_messages(app)
app.run_polling()
